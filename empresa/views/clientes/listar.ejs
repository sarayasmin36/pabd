<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Clientes</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" 
          rel="stylesheet">
</head>

<body>

<div class="container mt-4">

    <h2 class="mb-3">Lista de Clientes</h2>

    <a href="/clientes/cadastro" class="btn btn-primary mb-3">
        Cadastrar Novo Cliente
    </a>

    <table class="table table-bordered">
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>CPF</th>
                <th>Email</th>
                <th>Endereço</th>
                <th width="180">Ações</th>
            </tr>
        </thead>

        <tbody>

            <% clientes.forEach(c => { %>
            <tr>

                <td><%= c.id_cliente %></td>
                <td><%= c.nome %></td>
                <td><%= c.cpf %></td>
                <td><%= c.email %></td>
                <td><%= c.endereco %></td>

<td>

    <a href="/clientes/editar/<%= c.id_cliente %>" 
       class="btn btn-warning btn-sm">
        Editar
    </a>

    <% if (c.total_vendas > 0) { %>

        <div class="d-inline-block position-relative">

            <button
                type="button"
                class="btn btn-secondary btn-sm"
                style="cursor: pointer;"
                onclick="alert('Este cliente está em uma venda e não pode ser excluído!')"
                onmouseover="this.nextElementSibling.style.display='block'"
                onmouseout="this.nextElementSibling.style.display='none'">
                Excluir
            </button>

            <small
                class="text-danger position-absolute bg-white border rounded px-2 py-1"
                style="display:none; top:100%; left:0; white-space:nowrap;">
                Cliente possui vendas
            </small>

        </div>

    <% } else { %>

        <a href="/clientes/excluir/<%= c.id_cliente %>" 
           class="btn btn-danger btn-sm"
           onclick="return confirm('Deseja excluir este cliente?')">
            Excluir
        </a>

    <% } %>

</td>




            </tr>
            <% }) %>

        </tbody>

    </table>

    <a href="/" class="btn btn-secondary">
        Voltar
    </a>

</div>

</body>
</html>
